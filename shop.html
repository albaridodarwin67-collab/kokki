<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IronRide | Shop</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<nav>
    <div class="logo">IRONRIDE</div>
    <div class="search-container">
        <input type="text" id="shopSearch" placeholder="Search parts...">
    </div>
    <div class="menu">
        <a href="index.html">Home</a>
        <a href="shop.html" class="active">Shop</a>
        <a href="about.html">About</a>
        <a href="contact.html">Contact</a>
    </div>
</nav>

<main class="container">
    <div style="display: flex; justify-content: space-between; align-items: center; padding: 0 40px; margin-top: 20px;">
        <h2 class="section-title">High-Performance Inventory</h2>
        <button id="backToShop" style="display: none; padding: 10px 20px; background: #ff4d4d; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">‚Üê Back to Shop</button>
    </div>
    
    <h3 id="noResults" style="display: none; text-align: center; color: #ff4d4d; margin-top: 50px;">
        üö´ No parts found in the garage. Try another search!
    </h3>

    <div class="product-grid" id="pGrid">
        <div class="card"><div class="badge">Trending</div><img src="exhust.webp" alt="Exhaust"><h3>Titanium Slip-On Exhaust</h3><p class="price">‚Ç±18,500</p><button class="add-to-cart">Add to Cart</button></div>
        <div class="card"><img src="carb.png" alt="Helmet"><h3>Carbon Aero Helmet</h3><p class="price">‚Ç±12,200</p><button class="add-to-cart">Add to Cart</button></div>
        <div class="card"><img src="nit.jpg" alt="Shocks"><h3>Nitrogen Rear Shocks</h3><p class="price">‚Ç±8,400</p><button class="add-to-cart">Add to Cart</button></div>
        <div class="card"><div class="badge">Sale</div><img src="led.jpg" alt="Light"><h3>Projector LED Headlight</h3><p class="price">‚Ç±2,100</p><button class="add-to-cart">Add to Cart</button></div>
        <div class="card"><div class="badge">Trending</div><img src="mags.png" alt="Mags"><h3>Mags raizen</h3><p class="price">‚Ç±10,500</p><button class="add-to-cart">Add to Cart</button></div>
        <div class="card"><img src="dyno.jpeg" alt="swing arm"><h3>Dynopro +3</h3><p class="price">‚Ç±10,000</p><button class="add-to-cart">Add to Cart</button></div>
        <div class="card"><img src="caliper.jpeg" alt="caliper"><h3>Brembo 4pot</h3><p class="price">‚Ç±70,000</p><button class="add-to-cart">Add to Cart</button></div>
        <div class="card"><img src="mags2.jpeg" alt="mags"><h3>Mags</h3><p class="price">‚Ç±15,000</p><button class="add-to-cart">Add to Cart</button></div>
        <div class="card"><img src="tire.jpeg" alt="tire"><h3>Tires</h3><p class="price">‚Ç±70,000</p><button class="add-to-cart">Add to Cart</button></div>
        <div class="card"><img src="meter1.jpeg" alt="speedo"><h3>Speedometer</h3><p class="price">‚Ç±70,000</p><button class="add-to-cart">Add to Cart</button></div>
    </div>
</main>

<div id="cartSidebar" style="position: fixed; right: -400px; top: 0; width: 350px; height: 100%; background: #1a1a1a; border-left: 2px solid #ff4d4d; z-index: 2000; transition: 0.4s; padding: 25px; box-shadow: -10px 0 30px rgba(0,0,0,0.8); display: flex; flex-direction: column;">
    <button onclick="toggleCart()" style="position: absolute; top: 15px; right: 15px; background: none; border: none; color: #ff4d4d; font-size: 2.5rem; cursor: pointer;">&times;</button>
    
    <h2 style="color: #ff4d4d; border-bottom: 2px solid #333; padding-bottom: 10px;">Your Garage</h2>
    
    <div id="cartItemsList" style="flex-grow: 1; overflow-y: auto; margin-top: 15px;">
        <p id="emptyMsg" style="color: #555; text-align: center; margin-top: 40px;">Your garage is empty.</p>
    </div>

    <div style="border-top: 1px solid #333; padding-top: 20px; background: #1a1a1a;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <span style="color: #888; font-weight: bold;">TOTAL:</span>
            <span id="cartTotal" style="color: #ff4d4d; font-size: 1.5rem; font-weight: bold;">‚Ç±0</span>
        </div>
        <button id="finalCheckoutBtn" style="width: 100%; padding: 18px; background: #ff4d4d; color: white; border: none; border-radius: 8px; font-weight: 900; font-size: 1.2rem; cursor: pointer; text-transform: uppercase; box-shadow: 0 5px 20px rgba(255,77,77,0.4);">Proceed to Checkout</button>
    </div>
</div>

<button onclick="toggleCart()" style="position: fixed; bottom: 30px; right: 30px; width: 65px; height: 65px; border-radius: 50%; background: #ff4d4d; border: none; color: white; font-size: 26px; cursor: pointer; z-index: 1500; box-shadow: 0 4px 15px rgba(255,77,77,0.4);">üõí</button>

<script>
    let cart = [];
    const cartSidebar = document.getElementById('cartSidebar');
    const cartItemsList = document.getElementById('cartItemsList');
    const cartTotalDisplay = document.getElementById('cartTotal');
    const searchInput = document.getElementById('shopSearch');
    const cards = document.querySelectorAll('.card');
    const backBtn = document.getElementById('backToShop');

    function toggleCart() {
        const isClosed = cartSidebar.style.right === "-400px" || cartSidebar.style.right === "";
        cartSidebar.style.right = isClosed ? "0px" : "-400px";
    }

    // ATTACH ADD TO CART EVENTS
    function initButtons() {
        document.querySelectorAll('.add-to-cart').forEach(btn => {
            btn.onclick = function() {
                const card = this.closest('.card');
                const name = card.querySelector('h3').textContent;
                const price = parseInt(card.querySelector('.price').textContent.replace(/[‚Ç±,]/g, ''));

                cart.push({ name, price });
                
                // CHANGE BUTTON STATE
                this.innerText = "‚úì Added into Cart";
                this.style.background = "#28a745";
                this.style.borderColor = "#28a745";

                updateCartUI();
            };
        });
    }

    function updateCartUI() {
        cartItemsList.innerHTML = '';
        let total = 0;
        if (cart.length === 0) {
            cartItemsList.innerHTML = '<p style="color: #555; text-align: center; margin-top: 40px;">Your garage is empty.</p>';
        } else {
            cart.forEach((item, index) => {
                total += item.price;
                const div = document.createElement('div');
                div.style.cssText = "background: #222; padding: 12px; margin-bottom: 12px; border-radius: 8px; border-left: 4px solid #ff4d4d; display: flex; justify-content: space-between; align-items: center;";
                div.innerHTML = `
                    <div style="flex: 1;"><span style="display: block; font-weight: bold; color: white;">${item.name}</span><span style="color: #ff4d4d;">‚Ç±${item.price.toLocaleString()}</span></div>
                    <button onclick="removeItem(${index})" style="background: none; border: none; color: #ff4d4d; cursor: pointer; font-size: 1.5rem;">&times;</button>
                `;
                cartItemsList.appendChild(div);
            });
        }
        cartTotalDisplay.textContent = `‚Ç±${total.toLocaleString()}`;
    }

    window.removeItem = function(index) {
        const removedName = cart[index].name;
        cart.splice(index, 1);
        cards.forEach(card => {
            if(card.querySelector('h3').innerText === removedName) {
                const btn = card.querySelector('.add-to-cart');
                btn.innerText = "Add to Cart";
                btn.style.background = "";
            }
        });
        updateCartUI();
    };

    // SEARCH FILTER
    function runSearch(word) {
        let count = 0;
        backBtn.style.display = (word.length > 0) ? "block" : "none"; 
        cards.forEach(card => {
            const title = card.querySelector('h3').textContent.toLowerCase();
            if (title.includes(word.toLowerCase())) {
                card.style.display = "block";
                count++;
            } else {
                card.style.display = "none";
            }
        });
        document.getElementById('noResults').style.display = (count === 0) ? "block" : "none";
    }

    searchInput.addEventListener('input', (e) => runSearch(e.target.value));
    backBtn.onclick = () => { searchInput.value = ""; runSearch(""); };

    // CHECKOUT LOGIC
    document.getElementById('finalCheckoutBtn').onclick = () => {
        if (cart.length === 0) return alert("Your garage is empty!");
        alert(`your items already check out\nTotal Payment: ${cartTotalDisplay.textContent}`);
        cart = [];
        updateCartUI();
        toggleCart();
        document.querySelectorAll('.add-to-cart').forEach(btn => {
            btn.innerText = "Add to Cart";
            btn.style.background = "";
        });
    };

    // FIX FOR HOME PAGE LOAD
    window.onload = () => {
        initButtons();
        const urlParams = new URLSearchParams(window.location.search);
        const item = urlParams.get('item');
        if (item) {
            searchInput.value = item;
            runSearch(item);
        }
    };
</script>
</body>
</html>
